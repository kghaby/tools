#!/bin/bash

rm etot.dat
rm ektot.dat
rm eptot.dat

awk '/Etot/ {print $3}; ($1=="A" && $2=="V") {exit 0};' prod.mdout >> etot.dat

awk '/EKtot/ {print $6}; ($1=="A" && $2=="V") {exit 0};' prod.mdout >> ektot.dat

awk '/EPtot/ {print $9}; ($1=="A" && $2=="V") {exit 0};' prod.mdout >> eptot.dat

gnuplot -persist  << 'EOF'

	set multiplot layout 3,1 rowsfirst
	set offsets 
	set key off

	set ylabel "Tot. E. (kcal/mol)"
	plot 'etot.dat' with lines
	
	set ylabel "Kin. E. (kcal/mol)"
	plot 'ektot.dat' with lines
	
	set ylabel "Pot. E. (kcal/mol)"
	set xlabel "Frames"
	plot 'eptot.dat' with lines  
	
	pause -1

EOF
