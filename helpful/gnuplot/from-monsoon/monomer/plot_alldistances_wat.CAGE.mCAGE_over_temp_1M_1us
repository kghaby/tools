#!/bin/bash
set -e 

#using 1M (high) conc for ILs

#wat_B26Ca-B12Ca
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/253K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B26Ca-B12Ca >> distavg_wat_B26Ca-B12Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/294K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B26Ca-B12Ca >> distavg_wat_B26Ca-B12Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/310K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B26Ca-B12Ca >> distavg_wat_B26Ca-B12Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/350K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B26Ca-B12Ca >> distavg_wat_B26Ca-B12Ca.dat

#CAGE_B26Ca-B12Ca
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/253K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B26Ca-B12Ca >> distavg_CAGE_B26Ca-B12Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/294K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B26Ca-B12Ca >> distavg_CAGE_B26Ca-B12Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/310K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B26Ca-B12Ca >> distavg_CAGE_B26Ca-B12Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/350K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B26Ca-B12Ca >> distavg_CAGE_B26Ca-B12Ca.dat

#mCAGE_B26Ca-B12Ca
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/253K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B26Ca-B12Ca >> distavg_AAGE_B26Ca-B12Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/294K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B26Ca-B12Ca >> distavg_AAGE_B26Ca-B12Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/310K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B26Ca-B12Ca >> distavg_AAGE_B26Ca-B12Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/350K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B26Ca-B12Ca >> distavg_AAGE_B26Ca-B12Ca.dat



#wat_B28Ca-B8Ca
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/253K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B28Ca-B8Ca >> distavg_wat_B28Ca-B8Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/294K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B28Ca-B8Ca >> distavg_wat_B28Ca-B8Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/310K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B28Ca-B8Ca >> distavg_wat_B28Ca-B8Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/350K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B28Ca-B8Ca >> distavg_wat_B28Ca-B8Ca.dat

#CAGE_B28Ca-B8Ca
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/253K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B28Ca-B8Ca >> distavg_CAGE_B28Ca-B8Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/294K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B28Ca-B8Ca >> distavg_CAGE_B28Ca-B8Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/310K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B28Ca-B8Ca >> distavg_CAGE_B28Ca-B8Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/350K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B28Ca-B8Ca >> distavg_CAGE_B28Ca-B8Ca.dat

#mCAGE_B28Ca-B8Ca
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/253K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B28Ca-B8Ca >> distavg_AAGE_B28Ca-B8Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/294K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B28Ca-B8Ca >> distavg_AAGE_B28Ca-B8Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/310K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B28Ca-B8Ca >> distavg_AAGE_B28Ca-B8Ca.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/350K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_B28Ca-B8Ca >> distavg_AAGE_B28Ca-B8Ca.dat



#wat_A19O-B25H
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/253K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A19O-B25H >> distavg_wat_A19O-B25H.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/294K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A19O-B25H >> distavg_wat_A19O-B25H.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/310K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A19O-B25H >> distavg_wat_A19O-B25H.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/350K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A19O-B25H >> distavg_wat_A19O-B25H.dat

#CAGE_A19O-B25H
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/253K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A19O-B25H >> distavg_CAGE_A19O-B25H.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/294K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A19O-B25H >> distavg_CAGE_A19O-B25H.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/310K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A19O-B25H >> distavg_CAGE_A19O-B25H.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/350K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A19O-B25H >> distavg_CAGE_A19O-B25H.dat

#mCAGE_A19O-B25H
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/253K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A19O-B25H >> distavg_AAGE_A19O-B25H.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/294K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A19O-B25H >> distavg_AAGE_A19O-B25H.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/310K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A19O-B25H >> distavg_AAGE_A19O-B25H.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/350K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A19O-B25H >> distavg_AAGE_A19O-B25H.dat



#wat_A21neg-B22pos
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/253K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A21neg-B22pos >> distavg_wat_A21neg-B22pos.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/294K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A21neg-B22pos >> distavg_wat_A21neg-B22pos.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/310K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A21neg-B22pos >> distavg_wat_A21neg-B22pos.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer/simulation/4-prod/350K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A21neg-B22pos >> distavg_wat_A21neg-B22pos.dat

#CAGE_A21neg-B22pos
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/253K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A21neg-B22pos >> distavg_CAGE_A21neg-B22pos.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/294K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A21neg-B22pos >> distavg_CAGE_A21neg-B22pos.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/310K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A21neg-B22pos >> distavg_CAGE_A21neg-B22pos.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_CAGE/1M/simulation/4-prod/350K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A21neg-B22pos >> distavg_CAGE_A21neg-B22pos.dat

#mCAGE_A21neg-B22pos
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/253K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A21neg-B22pos >> distavg_AAGE_A21neg-B22pos.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/294K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A21neg-B22pos >> distavg_AAGE_A21neg-B22pos.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/310K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A21neg-B22pos >> distavg_AAGE_A21neg-B22pos.dat
./../../../analysis_scripts/avg_sterror 2 /scratch/ksg225/projects/insulin/insAB/monomer_AAGE/1M/simulation/4-prod/350K/converged_analysis/analysis_1us/rog_and_dist_1us/dist_A21neg-B22pos >> distavg_AAGE_A21neg-B22pos.dat


gnuplot -persist << EOF

        set terminal postscript eps enhanced color font "/usr/share/fonts/gnu-free/FreeSans.ttf, 28" solid size 10,7 linewidth 3 
        set output 'alldistances_wat.CAGE.mCAGE_over_temp_1M_1us.eps'
        set multiplot layout 2,2 rows
        set tmargin 0.5
        set bmargin 4
        set lmargin 8
        set rmargin 2   
	set pointsize 2
	
#B26Ca-B12Ca
        #set yrange [0:0.9]
        set ylabel 'B26(Ca)-B12(Ca) ({\305})' 
	set xrange [250:353]
	temperature = "253 294 310 350"
	set bars 4
	set nokey
plot "distavg_wat_B26Ca-B12Ca.dat"   using (word(temperature,int(column(0))+1)+0.0):1 with linespoints pt 7 lw 2 linecolor rgb "#0072B2" title "In Water" , "" using (word(temperature,int(column(0))+1)+0.0):1:3 with yerrorbars pt 7 lw 2 linecolor rgb "#0072B2" notitle,\
"distavg_CAGE_B26Ca-B12Ca.dat"  using (word(temperature,int(column(0))+1)+0.0):1 with linespoints pt 7 lw 2 linecolor rgb "#009E73" title "In CAGE" , "" using (word(temperature,int(column(0))+1)+0.0):1:3 with yerrorbars pt 7 lw 2 linecolor rgb "#009E73" notitle,\
"distavg_AAGE_B26Ca-B12Ca.dat"  using (word(temperature,int(column(0))+1)+0.0):1 with linespoints pt 7 lw 2 linecolor rgb "#D55E00" title "In mCAGE" , "" using (word(temperature,int(column(0))+1)+0.0):1:3 with yerrorbars pt 7 lw 2 linecolor rgb "#D55E00" notitle

#B28Ca-B8Ca
        #set yrange [0:0.9]
        set ylabel 'B28(Ca)-B8(Ca) ({\305})' 
        set xrange [250:353]
        temperature = "253 294 310 350"
	set bars 4
	set nokey
plot "distavg_wat_B28Ca-B8Ca.dat"   using (word(temperature,int(column(0))+1)+0.0):1  with linespoints pt 7 lw 2 linecolor rgb "#0072B2" title "In Water" , "" using (word(temperature,int(column(0))+1)+0.0):1:3 with yerrorbars pt 7 lw 2 linecolor rgb "#0072B2" notitle,\
"distavg_CAGE_B28Ca-B8Ca.dat"  using (word(temperature,int(column(0))+1)+0.0):1 with linespoints pt 7 lw 2 linecolor rgb "#009E73" title "In CAGE" , "" using (word(temperature,int(column(0))+1)+0.0):1:3 with yerrorbars pt 7 lw 2 linecolor rgb "#009E73" notitle,\
"distavg_AAGE_B28Ca-B8Ca.dat"  using (word(temperature,int(column(0))+1)+0.0):1 with linespoints pt 7 lw 2 linecolor rgb "#D55E00" title "In mCAGE" , "" using (word(temperature,int(column(0))+1)+0.0):1:3 with yerrorbars pt 7 lw 2 linecolor rgb "#D55E00" notitle

#A19O-B25H
        set xlabel 'Temperature (K)'
        #set yrange [0:0.9]
        set ylabel 'A19(O)-B25(H) ({\305})' 
        set xrange [250:353]
        temperature = "253 294 310 350"
	set bars 4
	set nokey
plot "distavg_wat_A19O-B25H.dat"   using (word(temperature,int(column(0))+1)+0.0):1  with linespoints pt 7 lw 2 linecolor rgb "#0072B2" title "In Water" , "" using (word(temperature,int(column(0))+1)+0.0):1:3 with yerrorbars pt 7 lw 2 linecolor rgb "#0072B2" notitle,\
"distavg_CAGE_A19O-B25H.dat"  using (word(temperature,int(column(0))+1)+0.0):1 with linespoints pt 7 lw 2 linecolor rgb "#009E73" title "In CAGE" , "" using (word(temperature,int(column(0))+1)+0.0):1:3 with yerrorbars pt 7 lw 2 linecolor rgb "#009E73" notitle,\
"distavg_AAGE_A19O-B25H.dat"  using (word(temperature,int(column(0))+1)+0.0):1 with linespoints pt 7 lw 2 linecolor rgb "#D55E00" title "In mCAGE" , "" using (word(temperature,int(column(0))+1)+0.0):1:3 with yerrorbars pt 7 lw 2 linecolor rgb "#D55E00" notitle

#A21neg-B22pos
        set xlabel 'Temperature (K)'
        #set yrange [0:0.9]
        set ylabel 'A21(Term. Os)-B22(Pos. Ns) ({\305})' 
        set xrange [250:353]
        temperature = "253 294 310 350"
	set bars 4
	set nokey
plot "distavg_wat_A21neg-B22pos.dat"   using (word(temperature,int(column(0))+1)+0.0):1  with linespoints pt 7 lw 2 linecolor rgb "#0072B2" title "In Water" , "" using (word(temperature,int(column(0))+1)+0.0):1:3 with yerrorbars pt 7 lw 2 linecolor rgb "#0072B2" notitle,\
"distavg_CAGE_A21neg-B22pos.dat"  using (word(temperature,int(column(0))+1)+0.0):1 with linespoints pt 7 lw 2 linecolor rgb "#009E73" title "In CAGE" , "" using (word(temperature,int(column(0))+1)+0.0):1:3 with yerrorbars pt 7 lw 2 linecolor rgb "#009E73" notitle,\
"distavg_AAGE_A21neg-B22pos.dat"  using (word(temperature,int(column(0))+1)+0.0):1 with linespoints pt 7 lw 2 linecolor rgb "#D55E00" title "In mCAGE" , "" using (word(temperature,int(column(0))+1)+0.0):1:3 with yerrorbars pt 7 lw 2 linecolor rgb "#D55E00" notitle

	pause -1

EOF

rm distavg_*_B26Ca-B12Ca.dat
rm distavg_*_B28Ca-B8Ca.dat
rm distavg_*_A19O-B25H.dat
rm distavg_*_A21neg-B22pos.dat

#gv alldistances_wat.CAGE.mCAGE_over_temp_1M_1us.eps 
epstopdf alldistances_wat.CAGE.mCAGE_over_temp_1M_1us.eps
